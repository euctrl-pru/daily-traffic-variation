<!DOCTYPE html>
<html lang="en">
<head>
	<title>Aviation Intelligence Portal</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"></script>
	<link rel=stylesheet href=https://use.fontawesome.com/releases/v5.7.2/css/all.css integrity=sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr crossorigin=anonymous>
	<meta name="description" content=".img-responsive { margin: 0 auto; max-width: 75% } .resp-container { position: relative; overflow: hidden; padding-top: 50.">
	
	<!-- Google Font -->
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Exo:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
	  <!-- Bootstrap CSS -->  
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css" integrity="sha384-xOolHFLEh07PJGoPkLv1IbcEPTNtaed2xpHsD9ESMhqIYd0nLMwNLD69Npy4HI+N" crossorigin="anonymous">
	<!-- Plugins CSS -->
	<link rel="stylesheet" type="text/css" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css">
	<!-- Theme CSS -->
	<link rel="stylesheet" type="text/css" href="assets/css/style.css">  
</head>

<body onresize="ResizeWindow()">

    <div id="content"></div>

    <script>
        document.addEventListener("DOMContentLoaded", function() {
            fetch('aiu-header.html')
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Network response was not ok');
                    }
                    return response.text();
                })
                .then(data => {
                    document.getElementById('content').innerHTML = data;
					
					// Comment for Denis: Here you can set the title and description for the header
					document.getElementById('aiu-header-title').textContent = "Daily traffic variation for region pairs";
                	document.getElementById('aiu-header-description').textContent = "An overview of the daily traffic variation for region pairs. Updated daily.";
                })
                .catch(error => {
                    console.error('There was a problem with the fetch operation:', error);
                });
        });
    </script>

<style>
	table, td {
		border: 1px solid black;
		border-collapse: collapse;
		background-color: White;
		padding: 5px;
		align: middle;    
	}
</style>

	<nav class="navbar navbar-expand-md navbar-dark sticky-top" style="background-color: lightslategray;">
	<!-- <nav class="navbar navbar-expand-md bg-dark navbar-dark fixed-top"> -->
	<!-- <a href="http://www.eurocontrol.int/"><img src="Pictures/Eurocontrol_logo_2010.svg" style="float:left" class="img" alt="Eurocontrol" width="50" height="50"></a> -->
    

<!--<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#collapsibleNavbar">
		<span class="navbar-toggler-icon"></span>
	</button>-->

	<!--<div class="collapse navbar-collapse" id="collapsibleNavbar">-->
		<ul class="nav navbar-nav">
			<li class="nav-item dropdown active">
				<a class="nav-link dropdown-toggle" href="#" id="navbardrop" data-toggle="dropdown"> Daily Traffic</a>
				<div class="dropdown-menu">
					<strong>&nbsp States</strong>
					<a class="dropdown-item" href="./DailyTrafficVariation-States.html"> Daily Variation</a>
					<a class="dropdown-item" href="./DailyTrafficRestart-States.html"> Overview of the evolution</a>

					<strong>&nbsp ACCs</strong>
					<a class="dropdown-item" href="./DailyTrafficVariation-ACCs.html"> Daily Variation</a>
					<a class="dropdown-item" href="./DailyTrafficRestart-ACCs.html"> Overview of the evolution</a>

					<strong>&nbsp Airports</strong>
					<a class="dropdown-item" href="./DailyTrafficVariation-Airports.html"> Daily Variation</a>
					<a class="dropdown-item" href="./DailyTrafficRestart-Airports.html"> Overview of the evolution</a>

					<strong>&nbsp Aircraft Operators</strong>
					<a class="dropdown-item" href="./DailyTrafficVariation-AOs.html"> Daily Variation</a>
					<a class="dropdown-item" href="./DailyTrafficRestart-AOs.html"> Overview of the evolution</a>
				</div>
			</li>

			<li class="nav-item dropdown">
				<a class="nav-link dropdown-toggle" href="#" id="navbardrop" data-toggle="dropdown"> Daily Punctuality</a>
				<div class="dropdown-menu">
					<a class="dropdown-item" href="./DailyPunctuality-States.html"> States</a>
					<a class="dropdown-item" href="./DailyPunctuality-Airports.html"> Airports</a>
				</div>
			</li>
			
			<li class="nav-item dropdown">
				<a class="nav-link dropdown-toggle" href="#" id="navbardrop" data-toggle="dropdown"> Daily Operated Schedules %</a>
				<div class="dropdown-menu">
					<a class="dropdown-item" href="./DailyOperatedSchedules-Airports.html"> Airports</a>
				</div>
			</li>
		</ul>
	</div>
</nav>



<br>

<div class="container-fluid">


	<table>
	  <tr>
		<td>
			<div style='float:left; padding-top: 5px; padding-left: 10px; padding-right: 30px' id="MetricPicker_div"></div>
			<div style='float:left; padding-top: 5px; padding-left: 10px; padding-right: 30px' id="ECACPicker_div"></div>
		</td>
	  </tr>
	  <tr>
		<td>
			<div id="RegionPairsChart_div"></div>
		</td>
	  </tr>
	  <tr>
		<td>
			<img src="STATFORRegionsMap.png" alt="RegionMap" style="width:600px;height:400px">
			<div id="MyTable1_div"></div>
		</td>
	  </tr>		
	</table>
</div>
</body>

<!-- ======================= Footer START -->
<div id="content-footer"></div>
<script>
	document.addEventListener("DOMContentLoaded", function() {
		fetch('aiu-footer.html')
			.then(response => {
				if (!response.ok) {
					throw new Error('Network response was not ok');
				}
				return response.text();
			})
			.then(data => {
				document.getElementById('content-footer').innerHTML = data;
			})
			.catch(error => {
				console.error('There was a problem with the fetch operation:', error);
			});
	});
</script>
<!-- ======================= Footer END -->

</html>

<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>

<script type="text/javascript">
		var SelectedStartDate = new Date(2020,4,1,0,0,0,0);
</script>

<script type="text/javascript">
		var Data;
		
		var MyChartRegionPairs;
		var MyEntityView;

		var MyWidthCharts = 650; 
		var MyHeightCharts = 300; 
		
		var hAxisTextPosition = 'out';
		var CharAreaHeight = '70%';

		var MetricPicker;
		var SelectedMetric = "Variation 2020 vs. 2019"; //  "2020 Flights"    "2019 Flights"    "Variation 2020 vs. 2019"

		var ECACPicker;
		var SelectedECAC = "Yes";
		var WithECAC = true;
		
		var MyTable1;
				
		if (window.innerWidth >1200) {
			MyWidthCharts = window.innerWidth*0.97;
			MyHeightCharts = window.innerHeight*0.88;
		}

		function ResizeWindow() {
			if (window.innerWidth >1200) {
				MyWidthCharts = window.innerWidth*0.97;
				MyHeightCharts = window.innerHeight*0.88;
			}
			else {
				MyWidthCharts = 1200*0.97;
				MyHeightCharts = 800*0.88;
			}
			drawDashboard();
		}
		
		google.load('visualization', '1.0', {'packages':['corechart', 'table', 'controls']});
		google.setOnLoadCallback(Initialisation);

		function Initialisation() {
			var query = new google.visualization.Query('https://docs.google.com/spreadsheets/d/1-qi6inBWRQ68SKRGVVPNBGiMU1bDuxBZsAh0itaJLfM/edit?usp=sharing');
			query.send(getData);
		}

		function getData(response) {
			Data = response.getDataTable();
			drawDashboard();
		}
		function drawDashboard() {
			MyChartRegionPairs = new google.visualization.ComboChart(document.getElementById('RegionPairsChart_div'));
			MyEntityView = new google.visualization.DataView(Data);
			
			var FormatterZeroDecimale = new google.visualization.NumberFormat({pattern:'#,###'});
			FormatterZeroDecimale.format(Data, 2);
			FormatterZeroDecimale.format(Data, 3);
			FormatterZeroDecimale.format(Data, 5);
			FormatterZeroDecimale.format(Data, 6);
			FormatterZeroDecimale.format(Data, 8);
			FormatterZeroDecimale.format(Data, 9);
			FormatterZeroDecimale.format(Data, 11);
			FormatterZeroDecimale.format(Data, 12);
			FormatterZeroDecimale.format(Data, 14);
			FormatterZeroDecimale.format(Data, 15);
			FormatterZeroDecimale.format(Data, 17);
			FormatterZeroDecimale.format(Data, 18);
			FormatterZeroDecimale.format(Data, 20);
			FormatterZeroDecimale.format(Data, 21);
			FormatterZeroDecimale.format(Data, 23);
			FormatterZeroDecimale.format(Data, 24);
			FormatterZeroDecimale.format(Data, 26);
			FormatterZeroDecimale.format(Data, 27);

			var FormatterPercentage = new google.visualization.NumberFormat({pattern:'0.0%'});
			FormatterPercentage.format(Data, 4);
			FormatterPercentage.format(Data, 7);
			FormatterPercentage.format(Data, 10);
			FormatterPercentage.format(Data, 13);
			FormatterPercentage.format(Data, 16);
			FormatterPercentage.format(Data, 19);
			FormatterPercentage.format(Data, 22);
			FormatterPercentage.format(Data, 25);

//________________________________________________________________________________________________________
			var dataMetrics = google.visualization.arrayToDataTable([
				["Metrics"],
				["2020 Flights"],
				["2019 Flights"],
				["Variation 2020 vs. 2019"],
			]);

			MetricPicker = new google.visualization.ControlWrapper({
				controlType: 'CategoryFilter',
				containerId: 'MetricPicker_div',
				dataTable: dataMetrics,
				state: {selectedValues: [SelectedMetric]},
				options: {
					filterColumnLabel: 'Metrics',
					ui: {
						label: 'Select Metric:',
						caption: '',
//						labelStacking: 'vertical',
						allowTyping: false,
						allowMultiple: false,
						sortValues: false,
						allowNone: false,
//						cssClass: 'ClassANSPPicker',
					},
				}
			});
			MetricPicker.draw();
			google.visualization.events.addListener(MetricPicker, 'statechange', changeMetricPicker);

			function changeMetricPicker() {
				SelectedMetric = MetricPicker.getState().selectedValues[0];
//				alert(SelectedMetric);
				updateDashboard();
			};
//________________________________________________________________________________________________________
			var dataECAC = google.visualization.arrayToDataTable([
				["Intra-ECAC"],
				["Yes"],
				["No"],
			]);

			ECACPicker = new google.visualization.ControlWrapper({
				controlType: 'CategoryFilter',
				containerId: 'ECACPicker_div',
				dataTable: dataECAC,
				state: {selectedValues: [SelectedECAC]},
				options: {
					filterColumnLabel: 'Intra-ECAC',
					ui: {
						label: 'Intra ECAC flow?',
						caption: '',
//						labelStacking: 'vertical',
						allowTyping: false,
						allowMultiple: false,
						sortValues: false,
						allowNone: false,
//						cssClass: 'ClassANSPPicker',
					},
				}
			});
			ECACPicker.draw();
			google.visualization.events.addListener(ECACPicker, 'statechange', changeECACPicker);

			function changeECACPicker() {
				SelectedECAC = ECACPicker.getState().selectedValues[0];
//				alert(SelectedECAC);
				if (SelectedECAC == "Yes") WithECAC = true; else WithECAC = false;
				updateDashboard();
			};
			updateDashboard();
		}
//________________________________________________________________________________________________________			


//________________________________________________________________________________________________________
//			MyTable1 = new google.visualization.Table(document.getElementById('MyTable1_div'));
//			var OptionsMyTable1 = {width: 800, height: 200};
//			MyTable1.draw(MyEntityView, OptionsMyTable1);	
//________________________________________________________________________________________________________

		function updateDashboard() {
			var MyFormatYAxis;
			var MyColor0, MyColor1, MyColor2, MyColor3, MyColor4, MyColor5, MyColor6, MyColor7, MyColor8;
			
			if (SelectedMetric == "2020 Flights") {
				if (WithECAC) MyEntityView.setColumns([0,2,5,8,11,14,17,20,23,26]); else MyEntityView.setColumns([0,5,8,11,14,17,20,23,26]);
				MyFormatYAxis = "#,###";
			}
			if (SelectedMetric == "2019 Flights") {
				if (WithECAC) MyEntityView.setColumns([1,3,6,9,12,15,18,21,24,27]); else MyEntityView.setColumns([1,6,9,12,15,18,21,24,27]);
				MyFormatYAxis = "#,###";
			}
			if (SelectedMetric == "Variation 2020 vs. 2019") {
				if (WithECAC) MyEntityView.setColumns([0,4,7,10,13,16,19,22,25,28]); else MyEntityView.setColumns([0,7,10,13,16,19,22,25,28]);
				MyFormatYAxis = "#.#%";
			}
			if (WithECAC) {
				MyColor0 = 'Blue';
				MyColor1 = 'Grey';
				MyColor2 = 'Purple';
				MyColor3 = 'Green';
				MyColor4 = 'Pink';
				MyColor5 = 'DarkOrange';
				MyColor6 = 'DarkBlue';
				MyColor7 = 'Red';
				MyColor8 = 'Gold';
			} else {
				MyColor0 = 'Grey';
				MyColor1 = 'Purple';
				MyColor2 = 'Green';
				MyColor3 = 'Pink';
				MyColor4 = 'DarkOrange';
				MyColor5 = 'DarkBlue';
				MyColor6 = 'Red';
				MyColor7 = 'Gold';
				MyColor8 = 'Gold';
			}
			var	optionsMyEntityChart = {
				title: "Region-Pairs",
				titlePosition: 'out',
				width: MyWidthCharts,
				height: MyHeightCharts,
				pointSize: 3,
				series: {
					0: {type:'line',color:MyColor0, pointSize: 5, lineWidth: 2, targetAxisIndex:0},
					1: {type:'line',color:MyColor1, pointSize: 5, lineWidth: 2, targetAxisIndex:0},
					2: {type:'line',color:MyColor2, pointSize: 5, lineWidth: 2, targetAxisIndex:0},
					3: {type:'line',color:MyColor3, pointSize: 5, lineWidth: 2, targetAxisIndex:0},
					4: {type:'line',color:MyColor4, pointSize: 5, lineWidth: 2, targetAxisIndex:0},
					5: {type:'line',color:MyColor5, pointSize: 5, lineWidth: 2, targetAxisIndex:0},
					6: {type:'line',color:MyColor6, pointSize: 5, lineWidth: 2, targetAxisIndex:0},
					7: {type:'line',color:MyColor7, pointSize: 5, lineWidth: 2, targetAxisIndex:0},
					8: {type:'line',color:MyColor8, pointSize: 5, lineWidth: 2, targetAxisIndex:0},
				},
				hAxis: {
					format: 'dd MMM YYYY',
					textPosition: hAxisTextPosition,
					textStyle: {fontSize: 12},
					slantedText: true,
					slantedTextAngle: 90,
					gridlines: {count: MyEntityView.getNumberOfRows()},
				},
				vAxes: {
					0: {format: MyFormatYAxis},
					textStyle: {fontSize: 12},
				},
				legend: {
					position: 'right',
//					maxLines: 2,
					textStyle: {fontSize: 12},
				},
				animation: {
					duration: 200,
					easing: 'inAndOut',
				},
				chartArea:{
					left:100,
					top:40,
					width:'80%',
					height:'80%'
				},
			};
			MyChartRegionPairs.draw(MyEntityView,optionsMyEntityChart);
		};
</script>



<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-RJ3R0C35X7"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-RJ3R0C35X7');
</script>