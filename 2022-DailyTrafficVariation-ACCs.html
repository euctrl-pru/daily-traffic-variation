<!DOCTYPE html>
<html lang="en">
<head>
	<title>Aviation Intelligence Portal</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"></script>
	<link rel=stylesheet href=https://use.fontawesome.com/releases/v5.7.2/css/all.css integrity=sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr crossorigin=anonymous>
	<meta name="description" content=".img-responsive { margin: 0 auto; max-width: 75% } .resp-container { position: relative; overflow: hidden; padding-top: 50.">
	
	<!-- Google Font -->
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Exo:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
	  <!-- Bootstrap CSS -->  
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css" integrity="sha384-xOolHFLEh07PJGoPkLv1IbcEPTNtaed2xpHsD9ESMhqIYd0nLMwNLD69Npy4HI+N" crossorigin="anonymous">
	<!-- Plugins CSS -->
	<link rel="stylesheet" type="text/css" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css">
	<!-- Theme CSS -->
	<link rel="stylesheet" type="text/css" href="assets/css/style.css">  
</head>

<body onresize="ResizeWindow()">

    <div id="content"></div>

    <script>
        document.addEventListener("DOMContentLoaded", function() {
            fetch('aiu-header.html')
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Network response was not ok');
                    }
                    return response.text();
                })
                .then(data => {
                    document.getElementById('content').innerHTML = data;
					
					// Comment for Denis: Here you can set the title and description for the header
					document.getElementById('aiu-header-title').textContent = "Daily traffic variation for ACCs";
                	document.getElementById('aiu-header-description').textContent = "An overview of the daily traffic variation for area control centres (ACC) in 2022.";
                })
                .catch(error => {
                    console.error('There was a problem with the fetch operation:', error);
                });
        });
    </script>

<style>
	table, td {
		border: 1px solid black;
		border-collapse: collapse;
		background-color: White;
		padding: 5px;
		align: middle;    
	}
</style>

	<nav id="sub-navbar" class="navbar navbar-expand-md navbar-dark sticky-top" style="background-color: lightslategray;">
	<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#collapsibleNavbar">
		<span class="navbar-toggler-icon"></span>
	</button>
	<!-- <nav class="navbar navbar-expand-md bg-dark navbar-dark fixed-top"> -->
	<!-- <a href="http://www.eurocontrol.int/"><img src="Pictures/Eurocontrol_logo_2010.svg" style="float:left" class="img" alt="Eurocontrol" width="50" height="50"></a> -->
    

<!--	<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#collapsibleNavbar">
		<span class="navbar-toggler-icon"></span>
	</button>-->

	<!--<div class="collapse navbar-collapse" id="collapsibleNavbar">-->
		<div class="collapse navbar-collapse" id="collapsibleNavbar">
		<ul class="nav navbar-nav">
			<li class="nav-item dropdown active">
				<a class="nav-link dropdown-toggle" href="#" id="navbardrop" data-toggle="dropdown"> Daily Traffic</a>
				<div class="dropdown-menu">
					<strong>&nbsp States</strong>
					<a class="dropdown-item" href="./DailyTrafficVariation-States.html"> Daily Variation</a>
					<a class="dropdown-item" href="./DailyTrafficRestart-States.html"> Overview of the evolution</a>

					<strong>&nbsp ACCs</strong>
					<a class="dropdown-item active" href="./DailyTrafficVariation-ACCs.html"> Daily Variation</a>
					<a class="dropdown-item" href="./DailyTrafficRestart-ACCs.html"> Overview of the evolution</a>

					<strong>&nbsp Airports</strong>
					<a class="dropdown-item" href="./DailyTrafficVariation-Airports.html"> Daily Variation</a>
					<a class="dropdown-item" href="./DailyTrafficRestart-Airports.html"> Overview of the evolution</a>

					<strong>&nbsp Aircraft Operators</strong>
					<a class="dropdown-item" href="./DailyTrafficVariation-AOs.html"> Daily Variation</a>
					<a class="dropdown-item" href="./DailyTrafficRestart-AOs.html"> Overview of the evolution</a>
				</div>
			</li>

			<li class="nav-item dropdown">
				<a class="nav-link dropdown-toggle" href="#" id="navbardrop" data-toggle="dropdown"> Daily Punctuality</a>
				<div class="dropdown-menu">
					<a class="dropdown-item" href="./DailyPunctuality-States.html"> States</a>
					<a class="dropdown-item" href="./DailyPunctuality-Airports.html"> Airports</a>
				</div>
			</li>
		</ul>
	</div>
</nav>

<!-- A script to automatically close the sub-menu after selecting an option -->
<script>
	$(document).ready(function () {
	  // Add event listener for all navbar links within the #sub-navbar
	  $('#sub-navbar .navbar-nav .nav-link').on('click', function (event) {
		// Check if the clicked link is part of a dropdown
		if ($(this).closest('.dropdown').length === 0) {
		  // Check if the #sub-navbar is currently expanded
		  if ($('#sub-navbar .navbar-collapse').hasClass('show')) {
			$('#sub-navbar .navbar-toggler').click(); // Trigger a click on the navbar toggler to collapse the #sub-navbar
		  }
		}
	  });
	});
</script>
<!-- End script -->

<br>

<div class="container-fluid">



	<table border="1">
		<tr>	
			<td>
				<h2>Daily Traffic Variation - ACCs (2022)</h2>
				<div style='float:left; padding-top: 5px; padding-left: 10px; padding-right: 30px' id="EntityPicker_div"></div>
				<div style='float:left; padding-top: 5px; padding-left: 10px; padding-right: 30px' id="IndicatorPicker_div"></div>
				<button type="button" class="btn btn-info" onclick="ButtonBackTo2021()"><i class="fa fa-step-backward"></i>&nbsp Back to 2021</button>
				<button type="button" class="btn btn-info" onclick="ButtonBackTo2023()"><i class="fa fa-step-forward"></i>&nbsp Back to 2023</button>
				<button type="button" class="btn btn-primary" onclick="Button0()"><i class="fa fa-calendar"></i>&nbsp From 1 January</button>
				<button type="button" class="btn btn-primary" onclick="Button1()"><i class="fa fa-calendar"></i>&nbsp From 1 April</button>
				<button type="button" class="btn btn-primary" onclick="Button2()"><i class="fa fa-calendar"></i>&nbsp From 1 July</button>
				<button type="button" class="btn btn-primary" onclick="Button3()"><i class="fa fa-calendar"></i>&nbsp From 1 October</button>
				<button type="button" class="btn btn-success" onclick="CopyAllImages()"><i class="fa fa-copy"></i>&nbsp Copy all images</button>
				<button type="button" class="btn btn-secondary" onclick="ButtonDownload()"><i class="fa fa-download"></i>&nbsp Download</button>
				<button type="button" class="btn btn-warning" onclick="About()"><i class="fa fa-question-circle"></i>&nbsp About</button>
				
				<div id="MyTable1_div"></div>
			</td>
		</tr> 
		<tr>	
			<td>
				<div id="MyEntityChart_div"></div>
<!--				<div id="MyEntityChartRangeFilter_div"></div> -->
			</td>
		</tr>
		<tr>	
			<td><div id="MyGeoEntityChart_div"></div></td>
		</tr>
	</table>
</div>	
</body>

<!-- ======================= Footer START -->
<div id="content-footer"></div>
<script>
	document.addEventListener("DOMContentLoaded", function() {
		fetch('aiu-footer.html')
			.then(response => {
				if (!response.ok) {
					throw new Error('Network response was not ok');
				}
				return response.text();
			})
			.then(data => {
				document.getElementById('content-footer').innerHTML = data;
			})
			.catch(error => {
				console.error('There was a problem with the fetch operation:', error);
			});
	});
</script>
<!-- ======================= Footer END -->

</html>

<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>

<script type="text/javascript">
		var Data;
		
		var MyEntityView;
		var MyEntityView1;
	
		var MyEntityChart;
		var MyGeoEntityChart;
//		var MyEntityChartRangeFilter;
//		var MyEntityChartRangeFilterView;
		
		var MyTable1;
		var SelectedIndicator = 'Flights';
		var SelectedEntity = 'Initialisation';
		var MyWidthCharts = 1950;
		var MyHeightCharts = 450;
		var MyWidthGeoCharts = 1950;
		var MyHeightGeoCharts = 450;

		var SelectedStartDate;
		var SelectedEndDate;
		var SelectedDate;		
		var SelectedDate2019;		

		var EntityPicker;
		var IndicatorPicker;
		
		var maxSecondScale;
		var minSecondScale;

		if (window.innerWidth >1200) {
			MyWidthCharts = window.innerWidth*0.97;
			MyWidthGeoCharts = MyWidthCharts;
		}

		google.load('visualization', '1.0', {'packages':['corechart', 'table', 'controls']});
		google.setOnLoadCallback(Initialisation);

		function ResizeWindow() {
			if (window.innerWidth >1200) {
				MyWidthCharts = window.innerWidth*0.97;
				MyWidthGeoCharts = MyWidthCharts;
			}
			else {
				MyWidthCharts = 1950;
				MyWidthGeoCharts = 1950;
			}
			drawDashboard();
		}

		function ButtonDownload() {
			var link=document.createElement('a');
			link.href = "https://www.eurocontrol.int/Economics/Download/2022/2022-ACCs.xlsx";
			link.click();
		}

		function ButtonBackTo2021() {
			window.open("2021-DailyTrafficVariation-ACCs.html","_parent");
		}
		function ButtonBackTo2023() {
			window.open("2023-DailyTrafficVariation-ACCs.html","_parent");
		}
		function Button0() {
			SelectedStartDate = new Date(2022,0,1,0,0,0,0);
			UpdateData();
			UpdateMyEntityChart();
//			UpdateMyEntityChartRangeFilter();
			SelectEntityInGeoEntityChart();
		}
		function Button1() {
			SelectedStartDate = new Date(2022,3,1,0,0,0,0);
			UpdateData();
			UpdateMyEntityChart();
//			UpdateMyEntityChartRangeFilter();
			SelectEntityInGeoEntityChart();
		}
		function Button2() {
			SelectedStartDate = new Date(2022,6,1,0,0,0,0);
			UpdateData();
			UpdateMyEntityChart();
//			UpdateMyEntityChartRangeFilter();
			SelectEntityInGeoEntityChart();
		}
		function Button3() {
			SelectedStartDate = new Date(2022,9,1,0,0,0,0);
			UpdateData();
			UpdateMyEntityChart();
//			UpdateMyEntityChartRangeFilter();
			SelectEntityInGeoEntityChart();
		}

		function CopyAllImages() {
			var myWidth =  MyEntityChart.getChartLayoutInterface().getBoundingBox('chartarea').width; //*1.3; //window.innerWidth;
			var myHeight = MyEntityChart.getChartLayoutInterface().getBoundingBox('chartarea').height*2; //*1.3; //window.innerHeight;
			var mySize = "width="+myWidth+",height="+myHeight; 
			
			var myWindow = window.open("", "MsgWindow", mySize);
			myWindow.document.write('<img src="' + MyEntityChart.getImageURI() + '"><img src="' + MyGeoEntityChart.getImageURI() + '">');
		}

		function About() {
			var myWidth = 500;
			var myHeight = 700;
			var mySize = "width="+myWidth+",height="+myHeight; 
			
			var myWindow = window.open("", "MsgWindow", mySize);
			myWindow.document.write("<div class='container-fluid'><link rel='stylesheet' href='https://maxcdn.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css'><h2>Daily Traffic Variation - ACCs</h2><p>This page presents the daily variation of Traffic<sup>1</sup> for the main European ACCs compared to 2019<sup>2</sup>.</p><p>Such variation can be explained by many different factors including:</p><ul><li>COVID-19.</li><li>Overall economic downturn.</li><li>Failure of airlines.</li><li>ANSPs' disruptions.</li><li>Airports' disruptions.</li><li>Traffic variation in 2019.</li></ul><p>The graphics on the right present the <strong><span style='color:darkBlue'>daily traffic (updated until yesterday)</span></strong>, the <strong><span style='color:DodgerBlue'>daily traffic in 2019 (as Reference)</span></strong>, the <strong><span style='color:Grey'>daily variation with 2019</span></strong> as well as the <strong><span style='color:red'>moving average of this daily variation over the last 7 days</span></strong>.</p><br><p><sup>1</sup>Traffic at ACC level = Total IFR Flights controlled by each ACC.</p><p><sup>2</sup>The comparison with previous year is made using the closest similar days: i.e. Friday 01/01/2021 is compared to Friday 04/01/2019.</p></td></div>");
		}

		function Initialisation() {
			var query = new google.visualization.Query('https://docs.google.com/spreadsheets/d/1xR4opXyB9mpWsYHdFzCUFMGTnx6BQZqz54uI4xe5vIo/edit?usp=sharing');
			query.send(getData);
		}

		function getData(response) {
			Data = response.getDataTable();
			drawDashboard();
		}
		function drawDashboard() {
			SelectedEndDate = Data.getValue(Data.getNumberOfRows()-1,2);
			SelectedDate = SelectedEndDate;
			SelectedDate2019 = Data.getValue(Data.getNumberOfRows()-1,8);

			var FormatterMiniDate = new google.visualization.DateFormat({formatType: 'short'});
			FormatterMiniDate.format(Data, 2);

			var FormatterZeroDecimale = new google.visualization.NumberFormat({pattern:'#,###'});
			FormatterZeroDecimale.format(Data, 3);
			FormatterZeroDecimale.format(Data, 4);

			var FormatterPercentage = new google.visualization.NumberFormat({pattern:'0.0%'});
			FormatterPercentage.format(Data, 5);
			FormatterPercentage.format(Data, 7);

//________________________________________________________________________________________________________
			EntityPicker = new google.visualization.ControlWrapper({
				controlType: 'CategoryFilter',
				containerId: 'EntityPicker_div',
				dataTable: Data,
				state: {selectedValues: [SelectedEntity]},
				options: {
					filterColumnLabel: 'Entity',
					ui: {
						label: 'Select ACC:',
						caption: '',
//						labelStacking: 'vertical',
						allowTyping: false,
						allowMultiple: false,
						sortValues: true,
						allowNone: false,
					},
				}
			});
			EntityPicker.draw();
			google.visualization.events.addListener(EntityPicker, 'statechange', changeEntityPicker);

			function changeEntityPicker() {
				SelectedEntity = EntityPicker.getState().selectedValues[0];
				UpdateData();
				UpdateMyEntityChart();
//				UpdateMyEntityChartRangeFilter();
				SelectEntityInGeoEntityChart();
			};	

//________________________________________________________________________________________________________
			var dataIndicators = google.visualization.arrayToDataTable([
				['Indicator'],
				['Flights'],
				['Flights 2019 (Reference)'],
				['% vs 2019 (Daily)'],
				['% vs 2019 (7-day Moving Average)'],
			]);

			IndicatorPicker = new google.visualization.ControlWrapper({
				controlType: 'CategoryFilter',
				containerId: 'IndicatorPicker_div',
				dataTable: dataIndicators,
				state: {selectedValues: [SelectedIndicator]},
				options: {
					filterColumnLabel: 'Indicator',
					ui: {
						label: 'Select Indicator:',
						caption: '',
//						labelStacking: 'vertical',
						allowTyping: false,
						allowMultiple: false,
						sortValues: false,
						allowNone: false,
//						cssClass: 'ClassANSPPicker',
					},
				}
			});
			IndicatorPicker.draw();
			google.visualization.events.addListener(IndicatorPicker, 'statechange', changeIndicatorPicker);

			function changeIndicatorPicker() {
				SelectedIndicator = IndicatorPicker.getState().selectedValues[0];
//				alert(SelectedIndicator);
				UpdateData();
				UpdateMyEntityChart();
				UpdateMyGeoEntityChart();
				SelectEntityInGeoEntityChart();
			};
//________________________________________________________________________________________________________			
			UpdateData();

			MyEntityChart = new google.visualization.ComboChart(document.getElementById('MyEntityChart_div'));
			google.visualization.events.addListener(MyEntityChart, 'select', selectMyEntityChart);
			UpdateMyEntityChart();

//			UpdateMyEntityChartRangeFilter();
			
			MyGeoEntityChart = new google.visualization.ComboChart(document.getElementById('MyGeoEntityChart_div'));
			google.visualization.events.addListener(MyGeoEntityChart, 'select', selectMyGeoEntityChart);
			UpdateMyGeoEntityChart();
		};			
			
		function UpdateData() {	
			MyGeoEntityView = new google.visualization.DataView(Data);
			MyGeoEntityView.setRows(Data.getFilteredRows([{column:2, value: SelectedDate, minValue: SelectedStartDate, maxValue: SelectedEndDate}]));

			var DataMyGeoEntityView = new google.visualization.DataTable();
			DataMyGeoEntityView1 = MyGeoEntityView.toDataTable()

			MyGeoEntityView1 = new google.visualization.DataView(DataMyGeoEntityView1);
			if (SelectedIndicator == 'Flights') MyGeoEntityView1.setColumns([0,4]);
			if (SelectedIndicator == 'Flights 2019 (Reference)') MyGeoEntityView1.setColumns([0,3]);
			if (SelectedIndicator == '% vs 2019 (Daily)') MyGeoEntityView1.setColumns([0,5]);
			if (SelectedIndicator == '% vs 2019 (7-day Moving Average)') MyGeoEntityView1.setColumns([0,7]);
			MyGeoEntityView1.setRows(MyGeoEntityView1.getSortedRows([{column: 1, desc: true}]));

			if (SelectedEntity=="Initialisation") {
				SelectedEntity = MyGeoEntityView1.getValue(0,0);
				EntityPicker.setState({selectedValues: [SelectedEntity]});
				EntityPicker.draw();
			}
//----------------------------------------------------------------------------------------------------------

			MyEntityView = new google.visualization.DataView(Data);
			MyEntityView.setRows(Data.getFilteredRows([{column:0, value: SelectedEntity},{column:2, minValue: SelectedStartDate, maxValue: SelectedEndDate}]));

			var DataMyEntityView = new google.visualization.DataTable();
			DataMyEntityView1 = MyEntityView.toDataTable()

			MyEntityView1 = new google.visualization.DataView(DataMyEntityView1);
			MyEntityView1.setColumns([2,4,3,5,7]);

/* //________________________________________________________________________________________________________
			MyTable1 = new google.visualization.Table(document.getElementById('MyTable1_div'));
			var OptionsMyTable1 = {width: 800, height: 200};
			MyTable1.draw(MyEntityView1, OptionsMyTable1);	
//________________________________________________________________________________________________________*/
			
			maxSecondScale=-10000;
			minSecondScale=10000;
			for(i=0;i<MyEntityView1.getNumberOfRows();i++) {
				if (MyEntityView1.getValue(i,3)>maxSecondScale) maxSecondScale=MyEntityView1.getValue(i,3);
				if (MyEntityView1.getValue(i,3)<minSecondScale) minSecondScale=MyEntityView1.getValue(i,3);
				if (MyEntityView1.getValue(i,4)>maxSecondScale) maxSecondScale=MyEntityView1.getValue(i,4);
				if (MyEntityView1.getValue(i,4)<minSecondScale) minSecondScale=MyEntityView1.getValue(i,4);
			}
			if (maxSecondScale>0.3) maxSecondScale = 0.3;
//			alert(maxSecondScale);
		};

//________________________________________________________________________________________________________

		function selectMyEntityChart() {
			if(MyEntityChart.getSelection() != "") {
				SelectedDate = MyEntityView1.getValue(MyEntityChart.getSelection()[0].row, 0);
				SelectedDate2019 = MyEntityView.getValue(MyEntityChart.getSelection()[0].row, 8);

				SelectedIndicator = MyEntityView1.getColumnLabel(MyEntityChart.getSelection()[0].column);
				UpdateData();
				UpdateMyEntityChart();
				UpdateMyGeoEntityChart();
				SelectEntityInGeoEntityChart();
				IndicatorPicker.setState({selectedValues: [SelectedIndicator]});
				IndicatorPicker.draw();
			}
		}

			
		function UpdateMyEntityChart() {
			var	optionsMyEntityChart = {
				title: SelectedEntity,
				titlePosition: 'out',
				width: MyWidthCharts,
				height: MyHeightCharts,
				pointSize: 3,
				dataOpacity: 0.5,
				series: {
					0: {type:'line', dataOpacity:1.0, color:'darkBlue', pointSize: 5, lineWidth: 2, targetAxisIndex:0},
					1: {type:'line', dataOpacity:1.0, color:'DodgerBlue', pointSize: 5, lineWidth: 2, targetAxisIndex:0},
					2: {type:'bars', color:'darkGrey', targetAxisIndex:1},
					3: {type:'line', dataOpacity:1.0, color:'red', pointSize: 5, lineWidth: 2, lineDashStyle: [4, 4], targetAxisIndex:1},
				},
				hAxis: {
					format: 'MMM dd, yyyy',
					textPosition: 'out',
					textStyle: {fontSize: 14},
					slantedText: true,
					slantedTextAngle: 90,
					showTextEvery: 2,
					gridlines: {count: MyEntityView1.getNumberOfRows()},
				},
				vAxes: {
					0: {format: '#,###'},
//					1: {format: '0%', maxValue: maxSecondScale, minValue: minSecondScale}
					1: {format: '0%', viewWindow: {max: maxSecondScale+0.02, min: minSecondScale-0.02}}
//					1: {format: '0%', viewWindow: {viewWindowMode: 'maximized'}}
				},

				legend: {
					position: 'bottom',
				},
				animation: {
					duration: 200,
					easing: 'inAndOut',
				},
				chartArea:{
					left:80,
					top:40,
					width:'90%',
					height:'60%'
				},
			};
				
			MyEntityChart.draw(MyEntityView1,optionsMyEntityChart);
			SelectDateInEntityChart();
		};

//________________________________________________________________________________________________________
			
/*		function UpdateMyEntityChartRangeFilter() {
			MyEntityView = new google.visualization.DataView(Data);
			MyEntityView.setRows(Data.getFilteredRows([{column:0, value: SelectedEntity}]));

			var DataMyEntityView = new google.visualization.DataTable();
			DataMyEntityView1 = MyEntityView.toDataTable()

			MyEntityChartRangeFilterView = new google.visualization.DataView(DataMyEntityView1);
			MyEntityChartRangeFilterView.setColumns([2,5,3,4,7]);

			MyEntityChartRangeFilter = new google.visualization.ControlWrapper({
				controlType: 'ChartRangeFilter',
				containerId: 'MyEntityChartRangeFilter_div',
				dataTable: MyEntityChartRangeFilterView,
				options: {
					filterColumnIndex: 0,
					state: {range: {start: SelectedStartDate, end: SelectedEndDate}},
					ui: {
						chartOptions: {
							width: MyWidthCharts,
							height: 100,
							dataOpacity: 0.5,
							series: {
								0: {type:'bars', color:'darkGrey', targetAxisIndex:1},
								1: {type:'line', dataOpacity:1.0, color:'DodgerBlue', pointSize: 5, lineWidth: 2, targetAxisIndex:0},
								2: {type:'line', dataOpacity:1.0, color:'darkBlue', pointSize: 5, lineWidth: 2, targetAxisIndex:0},
								3: {type:'line', dataOpacity:1.0, color:'red', pointSize: 5, lineWidth: 2, lineDashStyle: [4, 4], targetAxisIndex:1},
							},
//							colors: myColors,
							chartArea: {
								left:80,
//								top:00,
								width: '90%',
							},
							hAxis: {
//								format: '0',
//								slantedText: true,
//								slantedTextAngle: 90,
//								ticks: MyTicks2,
							},
							snapToData: true,
						},
					}
				}
			});
			MyEntityChartRangeFilter.setState({range: {start: SelectedStartDate, end: SelectedEndDate}});
			MyEntityChartRangeFilter.draw();
			google.visualization.events.addListener(MyEntityChartRangeFilter, 'statechange', changeMyEntityChartRangeFilter);

			function changeMyEntityChartRangeFilter(){
				SelectedStartDate = MyEntityChartRangeFilter.getState().range.start;
				SelectedEndDate = MyEntityChartRangeFilter.getState().range.end;

				UpdateData();
				UpdateMyEntityChart();
			};
		}*/
//________________________________________________________________________________________________________
		function SelectDateInEntityChart() {
			for(j = 0; j < MyEntityView1.getNumberOfRows(); j++) {
				if (MyEntityView1.getValue(j,0).toDateString() == SelectedDate.toDateString()) {
//					alert("Trouvé " + SelectedDate + " en " + j);
					MyEntityChart.setSelection([{row: j , column:null}]);
				}
			}
		};			
//________________________________________________________________________________________________________
		function selectMyGeoEntityChart() {
			if(MyGeoEntityChart.getSelection() != "") {
				SelectedEntity = MyGeoEntityView1.getValue(MyGeoEntityChart.getSelection()[0].row, 0);
				EntityPicker.setState({selectedValues: [SelectedEntity]});
				EntityPicker.draw();
				UpdateData();
				UpdateMyEntityChart();
//				UpdateMyEntityChartRangeFilter();
			}
		} 
			
		function UpdateMyGeoEntityChart() {
			var MyTitle;
			var MyColour;
			var MyFormat;
				
			if (SelectedIndicator == 'Flights') {
				MyTitle = "Flights - " + SelectedDate.toDateString();
				MyColour = 'darkBlue';
				MyFormat = '#,###';
			}
			if (SelectedIndicator == 'Flights 2019 (Reference)') {
				MyTitle = "Flights 2019 (Reference) - " + SelectedDate2019.toDateString();//2019
				MyColour = 'DodgerBlue';
				MyFormat = '#,###';
			}
			if (SelectedIndicator == '% vs 2019 (Daily)') {
				MyTitle = "% vs 2019 (Daily) - " + SelectedDate.toDateString();
				MyColour = 'darkGrey';
				MyFormat = '0%';
			}
			if (SelectedIndicator == '% vs 2019 (7-day Moving Average)') {
				MyTitle = "% vs 2019 (7-day Moving Average) - " + SelectedDate.toDateString();
				MyColour = 'red';
				MyFormat = '0%';
			}
				
			var	optionsMyGeoEntityChart = {
				title: MyTitle,
				titlePosition: 'out',
				width: MyWidthGeoCharts,
				height: MyHeightGeoCharts,
				pointSize: 3,
				series: {
					0: {type:'bars',color: MyColour, pointSize: 5, targetAxisIndex:0},
				},
				hAxis: {
//					format: 'dd/mm/yyyy',
					textPosition: 'out',
					textStyle: {fontSize: 14},
					slantedText: true,
					slantedTextAngle: 90,
					gridlines: { count: MyEntityView1.getNumberOfRows()},
				},
				vAxes: {
					0: {format: MyFormat}
				},
				vAxis: {
					viewWindow: {
//						viewWindowMode: 'maximized'
//						min: -1.0
					}
				},
				legend: {
					position: 'none',
				},
				animation: {
					duration: 200,
					easing: 'inAndOut',
				},
				chartArea:{
					left:80,
					top:40,
					width:'90%',
					height:'50%'
				},
			};
				
			MyGeoEntityChart.draw(MyGeoEntityView1,optionsMyGeoEntityChart);
			SelectEntityInGeoEntityChart();
		};
			
//________________________________________________________________________________________________________
		function SelectEntityInGeoEntityChart() {
			for(j = 0; j < MyGeoEntityView1.getNumberOfRows(); j++) {
				if (MyGeoEntityView1.getValue(j,0) == SelectedEntity) {
//					alert("Trouvé " + SelectedEntity + " en " + j);
					MyGeoEntityChart.setSelection([{row: j , column:null}]);
				}
			}
		};
</script>


<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-RJ3R0C35X7"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-RJ3R0C35X7');
</script>